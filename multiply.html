<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiplication Master | BrainiacGym</title>
    <style>
        :root {
            --primary: #F58220;
            --secondary: #2d3436;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --success-color: #27ae60;
            --error-color: #c0392b;
            --gray-bar: #f1f2f6;
            --gray-label: #636e72;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            margin: 0; padding: 0;
            padding-top: 100px;
            color: var(--secondary);
            user-select: none;
        }

        /* --- HEADER --- */
        header {
            position: fixed; top: 0; left: 0; width: 100%;
            height: 60px; background: white;
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 5%; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            z-index: 1000;
            box-sizing: border-box;
        }
        .logo { height: 40px; }
        .nav-links { display: flex; gap: 20px; }
        .nav-links a { text-decoration: none; color: #555; font-weight: 600; font-size: 0.95rem; }

        /* --- CONTAINER --- */
        .container { max-width: 600px; margin: 0 auto; padding: 0 20px; }
        .card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            text-align: center;
            border-top: 6px solid var(--primary);
        }

        /* --- STATS BAR --- */
        .stats-bar {
            display: flex; justify-content: space-between;
            background: var(--gray-bar);
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 700;
            color: var(--gray-label);
            margin-bottom: 20px;
            font-size: 1rem;
        }

        .score-badges {
            display: flex; justify-content: center; gap: 15px; margin-bottom: 20px;
        }
        .badge {
            padding: 8px 25px;
            border-radius: 50px;
            font-size: 0.95rem;
            font-weight: 800;
            color: white;
        }
        .badge-green { background-color: var(--success-color); }
        .badge-red { background-color: var(--error-color); }

        /* --- INPUTS --- */
        .input-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px;
            margin-bottom: 15px; text-align: left;
        }
        label { display: block; margin-bottom: 5px; font-weight: 700; color: var(--gray-label); font-size: 0.85rem; }
        input[type="number"] {
            width: 100%; padding: 12px; border: 2px solid #dfe6e9;
            border-radius: 10px; font-size: 1.1rem; outline: none; box-sizing: border-box;
        }

        /* --- SETTINGS BOX --- */
        .settings-box {
            background: #f8f9fa; padding: 20px; border-radius: 15px;
            margin-bottom: 25px; text-align: left; border: 1px solid #edf2f4;
        }
        .checkbox-row { display: flex; align-items: center; gap: 12px; margin-bottom: 5px; }
        .checkbox-row input[type="checkbox"] { 
            width: 22px; height: 22px; accent-color: var(--primary); cursor: pointer;
        }
        .divider { border: none; border-top: 1px dashed #ccc; margin: 15px 0; }
        #auto-options { display: none; }

        /* --- BUTTONS --- */
        .btn {
            width: 100%; padding: 18px; border: none; border-radius: 50px;
            font-size: 1.1rem; font-weight: 800; cursor: pointer;
            color: white; text-transform: uppercase; transition: transform 0.1s;
        }
        .btn-start { background: var(--primary); box-shadow: 0 5px 15px rgba(245, 130, 32, 0.3); }
        .btn-stop { background: #636e72; margin-top: 10px; }
        .btn:active { transform: scale(0.98); }

        /* --- DISPLAY --- */
        #flash-display { 
            font-size: clamp(3rem, 10vw, 5rem); 
            font-weight: 800; 
            margin: 30px 0; 
            min-height: 120px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }
        .result-bubble {
            background: var(--primary); color: white; padding: 15px 40px;
            border-radius: 50px; font-size: 2.5rem; font-weight: 800;
            display: inline-flex; margin-bottom: 20px;
        }

        .screen { display: none; }
        .screen.active { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<header>
    <img src="https://brainiacgym.com/wp-content/uploads/2023/10/Brainiacgym-Final-1.png" alt="Logo" class="logo">
    <nav class="nav-links">
        <a href="index.html">Home</a>
        <a href="#">About</a>
        <a href="#">Courses</a>
        <a href="#">Contact</a>
    </nav>
</header>

<div class="container">
    
    <div id="setup-screen" class="screen active">
        <div class="card">
            <h2 style="margin-top:0;">Multiplication Setup</h2>
            
            <div class="input-grid">
                <div><label>Range 1 (Low)</label><input type="number" id="low1" value="2"></div>
                <div><label>Range 1 (High)</label><input type="number" id="high1" value="9"></div>
            </div>
            <div class="input-grid">
                <div><label>Range 2 (Low)</label><input type="number" id="low2" value="2"></div>
                <div><label>Range 2 (High)</label><input type="number" id="high2" value="9"></div>
            </div>
            <div class="input-grid">
                <div><label>Total Questions</label><input type="number" id="totalSums" value="10"></div>
                <div><label>Time Limit (Sec)</label><input type="number" id="totalTime" value="60"></div>
            </div>

            <div class="settings-box">
                <div class="checkbox-row">
                    <input type="checkbox" id="flashMode" onchange="toggleAuto()">
                    <label for="flashMode" style="font-weight:600; cursor:pointer;">Flash Mode (Mental Math)</label>
                </div>
                
                <div id="auto-options">
                    <div class="divider"></div>
                    <div class="checkbox-row">
                        <input type="checkbox" id="autoLoop">
                        <label for="autoLoop" style="font-weight:600; cursor:pointer;">Auto Next Question</label>
                    </div>
                    <label style="margin-top:15px; display:block; font-weight:600; color:var(--gray-label);">Wait Time (Sec):</label>
                    <input type="number" id="autoDelay" value="2">

                    <label style="margin-top:15px; display:block; font-weight:600; color:var(--gray-label);">View Speed (Sec)</label>
                    <input type="number" id="speed" value="2" step="0.5">
                </div>
            </div>

            <button class="btn btn-start" onclick="startApp()">START PRACTICE</button>
        </div>
    </div>

    <div id="game-screen" class="screen">
        <div class="card">
            <div class="stats-bar">
                <span id="timer-display">60.0s</span>
                <span id="progress-display">Q: 1/10</span>
            </div>

            <div class="score-badges">
                <div class="badge badge-green">Right: <span id="right-count">0</span></div>
                <div class="badge badge-red">Wrong: <span id="wrong-count">0</span></div>
            </div>

            <div id="flash-display"></div>
            
            <div id="answer-area" style="display:none;">
                <div id="result-bubble" class="result-bubble" style="display:none"></div>
                <h3 id="feedback-text" style="color:var(--gray-label); margin-top:0;">What is the product?</h3>
                <input type="number" id="user-ans" placeholder="?" style="text-align:center; font-size: 2rem; height: 70px; margin-bottom: 20px; width: 80%;">
            </div>

            <button id="check-btn" class="btn btn-start" onclick="checkAns()">CHECK ANSWER</button>
            <button id="stop-btn" class="btn btn-stop" onclick="stopGame()">STOP PRACTICE</button>
        </div>
    </div>

</div>

<script>
    function toggleAuto() {
        const isFlash = document.getElementById("flashMode").checked;
        document.getElementById("auto-options").style.display = isFlash ? "block" : "none";
    }

    let correctAnswer = 0;
    let currentSumIndex = 1;
    let totalSums = 0;
    let timeLeft = 0;
    let rightCount = 0;
    let wrongCount = 0;
    
    let isFlash = false;
    let isAuto = false;
    let waitTime = 2000;
    let viewSpeed = 2000;
    
    let timerInterval, autoTimer, countdownTimer;

    function startApp() {
        totalSums = parseInt(document.getElementById("totalSums").value);
        timeLeft = parseFloat(document.getElementById("totalTime").value);
        
        isFlash = document.getElementById("flashMode").checked;
        isAuto = isFlash && document.getElementById("autoLoop").checked; 
        waitTime = parseFloat(document.getElementById("autoDelay").value) * 1000;
        viewSpeed = parseFloat(document.getElementById("speed").value) * 1000;

        rightCount = 0;
        wrongCount = 0;
        currentSumIndex = 1;

        showScreen("game-screen");
        startTimer();
        generateQuestion();
    }

    function startTimer() {
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(() => {
            timeLeft -= 0.1;
            if (timeLeft <= 0) {
                timeLeft = 0;
                endSession("Time's Up!");
            }
            updateUI();
        }, 100);
    }

    function generateQuestion() {
        clearTimers();
        const l1 = parseFloat(document.getElementById("low1").value);
        const h1 = parseFloat(document.getElementById("high1").value);
        const l2 = parseFloat(document.getElementById("low2").value);
        const h2 = parseFloat(document.getElementById("high2").value);

        // Generate numbers and handle decimals
        const n1 = (Math.random() * (h1 - l1) + l1).toFixed(1);
        const n2 = (Math.random() * (h2 - l2) + l2).toFixed(1);
        correctAnswer = parseFloat((n1 * n2).toFixed(2));

        const display = document.getElementById("flash-display");
        const ansArea = document.getElementById("answer-area");
        const checkBtn = document.getElementById("check-btn");

        display.innerText = `${n1} × ${n2}`;
        display.style.display = "flex";
        ansArea.style.display = "none";
        checkBtn.style.display = "none";

        // Hide question after "View Speed"
        autoTimer = setTimeout(setupAnswerMode, viewSpeed);
        updateUI();
    }

    function setupAnswerMode() {
        clearTimers();
        const display = document.getElementById("flash-display");
        const ansArea = document.getElementById("answer-area");
        const bubble = document.getElementById("result-bubble");
        const feedback = document.getElementById("feedback-text");
        const input = document.getElementById("user-ans");
        const checkBtn = document.getElementById("check-btn");

        display.style.display = isFlash ? "none" : "flex";
        ansArea.style.display = "block";
        bubble.style.display = "none";
        checkBtn.style.display = "block";

        if (isFlash) {
            input.style.display = "none";
            feedback.innerText = "Mental Calculation...";
            checkBtn.innerText = "SHOW ANSWER";
            checkBtn.onclick = revealFlashAnswer;

            if (isAuto) {
                let sec = Math.ceil(waitTime / 1000);
                checkBtn.innerText = `REVEALING IN ${sec}s`;
                countdownTimer = setInterval(() => {
                    sec--;
                    if (sec > 0) checkBtn.innerText = `REVEALING IN ${sec}s`;
                    else clearInterval(countdownTimer);
                }, 1000);
                autoTimer = setTimeout(revealFlashAnswer, waitTime);
            }
        } else {
            input.style.display = "block";
            input.value = "";
            input.focus();
            feedback.innerText = "What is the product?";
            checkBtn.innerText = "CHECK ANSWER";
            checkBtn.onclick = checkAns;
        }
    }

    function revealFlashAnswer() {
        clearTimers();
        const bubble = document.getElementById("result-bubble");
        const checkBtn = document.getElementById("check-btn");
        
        bubble.style.display = "inline-flex";
        bubble.style.background = "var(--primary)";
        bubble.innerText = correctAnswer;
        
        checkBtn.innerText = "NEXT QUESTION";
        checkBtn.onclick = nextQuestion;

        if (isAuto) {
            let sec = Math.ceil(waitTime / 1000);
            checkBtn.innerText = `NEXT IN ${sec}s`;
            countdownTimer = setInterval(() => {
                sec--;
                if (sec > 0) checkBtn.innerText = `NEXT IN ${sec}s`;
                else clearInterval(countdownTimer);
            }, 1000);
            autoTimer = setTimeout(nextQuestion, waitTime);
        }
    }

    function checkAns() {
        const user = parseFloat(document.getElementById("user-ans").value);
        const bubble = document.getElementById("result-bubble");
        const feedback = document.getElementById("feedback-text");

        bubble.innerText = correctAnswer;
        bubble.style.display = "inline-flex";

        // Precise decimal comparison
        if (Math.abs(user - correctAnswer) < 0.01) {
            bubble.style.background = "var(--success-color)";
            feedback.innerText = "CORRECT! ✓";
            rightCount++;
        } else {
            bubble.style.background = "var(--error-color)";
            feedback.innerText = "WRONG!";
            wrongCount++;
        }

        updateUI();
        document.getElementById("check-btn").style.display = "none";
        setTimeout(nextQuestion, 1500);
    }

    function nextQuestion() {
        clearTimers();
        if (currentSumIndex < totalSums && timeLeft > 0) {
            currentSumIndex++;
            generateQuestion();
        } else {
            endSession(timeLeft <= 0 ? "Time's Up!" : "Practice Complete!");
        }
    }

    function updateUI() {
        document.getElementById("timer-display").innerText = `${timeLeft.toFixed(1)}s`;
        document.getElementById("right-count").innerText = rightCount;
        document.getElementById("wrong-count").innerText = wrongCount;
        document.getElementById("progress-display").innerText = `Q: ${currentSumIndex}/${totalSums}`;
    }

    function endSession(msg) {
        clearInterval(timerInterval);
        clearTimers();
        const display = document.getElementById("flash-display");
        display.innerText = msg;
        display.style.display = "flex";
        document.getElementById("answer-area").style.display = "none";
        document.getElementById("check-btn").style.display = "none";
        
        const stopBtn = document.getElementById("stop-btn");
        stopBtn.innerText = "RESTART";
        stopBtn.onclick = () => location.reload();
    }

    function stopGame() {
        clearInterval(timerInterval);
        clearTimers();
        showScreen("setup-screen");
    }

    function clearTimers() {
        clearTimeout(autoTimer);
        clearInterval(countdownTimer);
    }

    function showScreen(id) {
        document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
        document.getElementById(id).classList.add("active");
    }

    document.getElementById("user-ans").addEventListener("keypress", (e) => {
        if (e.key === "Enter") checkAns();
    });
</script>
</body>
</html>